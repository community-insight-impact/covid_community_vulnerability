import pandas as pd
import numpy as np
import sklearn as skl
from sklearn import preprocessing
import matplotlib.pyplot as plt


PRINTING = 1


#############
# Load Data #
#############

if PRINTING:
    print('Loading data...')

data = pd.read_csv('../data/merged_data.csv', dtype={'FIPS': object})


###############
# Load Scores #
###############

if PRINTING:
    print('Loading scores...')

scores = pd.read_csv('../data/scores.csv', dtype={'FIPS': object})


##############################
# Severe COVID Complications #
##############################

if PRINTING:
    print('Creating Severe COVID Complications...')

# Create DF
severe = scores[['FIPS', 'State', 'County', 'severe_cases']].copy()

# Merge
severe = severe.merge(data[['covid_cases', '% Adults 65 and Older', '% Diagnosed Diabetes', '%  Adults with Obesity',
                            'Heart Disease Death Rate', 'Hypertension Death Rate', 'COPD Mortality Rate',
                            '% Smokers', 'FIPS']], on='FIPS')

# Clean
severe = severe.rename(columns={'severe_cases': 'Severe COVID Case Complications'})

# Write
severe.to_csv('../data/severe_cases_score_data.csv')


#################
# Economic Harm #
#################

## IN PROGRESS ##

# if PRINTING:
#     print('Creating Economic Harm...')

# # Create DF
# economic = scores[['FIPS', 'State', 'County', 'economic']].copy()

# # Merge
# economic = economic.merge(data[['% Uninsured', '% Children in Poverty', 'Income Ratio', '% Single-Parent Households',
#                                 '% Severe Housing Cost Burden', '% Severe Housing Problems',
#                                 '% Enrolled in Free or Reduced Lunch', '% Unemployed', 'FIPS',
#                                 'High School Graduation Rate']], on='FIPS')

# # Clean
# economic = economic.rename(columns={'economic': 'Risk of Severe Economic Harm'})

# # Write
# economic.to_csv('../data/economic_score_data.csv')


#################
# Mobile Health #
#################

if PRINTING:
    print('Creating Mobile Health...')

# Create DF
mobile = scores[['FIPS', 'State', 'County', 'mobile_health']].copy()

# Merge
mobile = mobile.merge(data[['% Rural', '% households wo car', '% workers commuting by public transit',
                            'Primary Care Physicians Rate', '% Without Health Insurance', '% Nonwhite',
                            '% Limited English Proficiency', '% Veterans in Civilian Adult Population',
                            '% Adults 65 and Older', '% disabled', 'opioid death rate', '% Fair or Poor Health',
                            'Number of Hospitals', 'FIPS']], on='FIPS')

# Clean
mobile = mobile.rename(columns={'mobile_health': 'Need for Mobile Health Resources', 'internet_percent': '% Home Internet Access'})

# Write
mobile.to_csv('../data/mobile_health_score_data.csv')
